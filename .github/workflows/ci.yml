name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: Build and Test
    runs-on: macos-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Select Xcode
      run: sudo xcode-select -s /Applications/Xcode_15.2.app/Contents/Developer

    - name: Build Framework
      run: xcodebuild -scheme PlayerControls -destination 'platform=macOS' build

    - name: Run Tests
      run: xcodebuild -scheme PlayerControls -destination 'platform=macOS' test

    - name: Build Demo App
      run: xcodebuild -scheme PlayerControlsDemo -destination 'platform=macOS' build

  spm:
    name: Swift Package Manager
    runs-on: macos-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Swift Build
      run: swift build

    - name: Swift Test
      run: swift test
